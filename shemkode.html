<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> שם קוד - גרסה משודרגת</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --blue-color: #1a73e8;
            --red-color: #e53935;
            --neutral-color: #f5d76e;
            --assassin-color: #202124;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #333333;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
        }

        body {
            font-family: 'Heebo', Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2, h3 {
            color: #222;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 2.5rem;
            margin-top: 20px;
            position: relative;
            display: inline-block;
        }

            h1::after {
                content: '';
                position: absolute;
                bottom: -10px;
                left: 10%;
                width: 80%;
                height: 3px;
                background: linear-gradient(90deg, var(--blue-color), var(--red-color));
                border-radius: 3px;
            }

        .game-board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-gap: 12px;
            max-width: 950px;
            margin: 25px auto;
        }

        .card {
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            padding: 10px;
        }

            .card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 5px;
                background-color: #ddd;
                transition: all 0.3s ease;
            }

            .card:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            }

        .blue {
            background-color: var(--blue-color);
            color: white;
        }

            .blue::before {
                background-color: #0d47a1;
            }

        .red {
            background-color: var(--red-color);
            color: white;
        }

            .red::before {
                background-color: #b71c1c;
            }

        .neutral {
            background-color: var(--neutral-color);
            color: #5d4037;
        }

            .neutral::before {
                background-color: #f1c40f;
            }

        .assassin {
            background-color: var(--assassin-color);
            color: white;
        }

            .assassin::before {
                background-color: #000000;
            }

        .controls {
            margin: 20px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            background-color: #f0f0f0;
            color: #333;
            font-family: 'Heebo', Arial, sans-serif;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--shadow);
            font-size: 1rem;
        }

            button:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            }

            button:active {
                transform: translateY(0);
            }

        .primary-btn {
            background-color: var(--blue-color);
            color: white;
        }

        .secondary-btn {
            background-color: var(--red-color);
            color: white;
        }

        .neutral-btn {
            background-color: #f5f5f5;
            color: #333;
        }

        .turn-indicator {
            margin: 15px 0;
            font-weight: bold;
            font-size: 1.5rem;
            padding: 10px 20px;
            border-radius: 50px;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .blue-turn {
            background-color: rgba(26, 115, 232, 0.15);
            color: var(--blue-color);
        }

        .red-turn {
            background-color: rgba(229, 57, 53, 0.15);
            color: var(--red-color);
        }

        /* עיצוב למסכי כניסה וטפסים */
        .welcome-panel {
            max-width: 700px;
            margin: 40px auto;
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .role-selection {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
        }

        .role-card {
            width: 180px;
            padding: 20px;
            border-radius: var(--border-radius);
            background-color: white;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

            .role-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            }

            .role-card.selected {
                border-color: var(--blue-color);
                background-color: rgba(26, 115, 232, 0.05);
            }

            .role-card img {
                width: 60px;
                height: 60px;
                margin-bottom: 10px;
            }

            .role-card h3 {
                margin: 10px 0;
            }

        .game-code-container {
            max-width: 100%;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #eee;
            border-radius: var(--border-radius);
            background-color: #fcfcfc;
        }

        .game-code-input {
            padding: 12px;
            width: 200px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            text-align: center;
            letter-spacing: 2px;
            font-family: monospace;
            margin-right: 10px;
        }

        .game-code-display {
            padding: 15px;
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 4px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 24px;
            letter-spacing: 3px;
        }

        #gameContainer {
            display: none; /* מוסתר בהתחלה עד שיוצרים או מצטרפים למשחק */
        }

        .divider {
            height: 1px;
            background-color: #eee;
            margin: 25px 0;
            position: relative;
        }

            .divider::after {
                content: 'או';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: white;
                padding: 0 10px;
                color: #777;
            }

        /* אנימציות */
        @keyframes reveal {
            0% {
                transform: rotateY(90deg);
                opacity: 0;
            }

            100% {
                transform: rotateY(0);
                opacity: 1;
            }
        }

        .card.revealed {
            animation: reveal 0.5s ease-out forwards;
        }

        .role-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        /* מידע על המשחק */
        .game-info {
            padding: 15px;
            margin: 15px 0;
            border-radius: var(--border-radius);
            background-color: #f0f0f0;
            max-width: 600px;
            text-align: right;
        }

        .current-game-info {
            background-color: #e0f7fa;
            padding: 10px 15px;
            border-radius: 50px;
            font-size: 0.9rem;
            display: inline-block;
            margin-bottom: 15px;
        }

        /* התאמה למסכים קטנים */
        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: repeat(5, 1fr);
                grid-gap: 8px;
            }

            .card {
                height: 70px;
                font-size: 0.9rem;
                padding: 5px;
            }

            .role-card {
                width: 140px;
                padding: 15px;
            }

            .game-code-display {
                font-size: 18px;
            }
        }

        /* התאמה למסכים מאוד קטנים */
        @media (max-width: 480px) {
            .card {
                height: 60px;
                font-size: 0.8rem;
            }

            .controls button {
                padding: 8px 12px;
                font-size: 0.9rem;
            }

            .turn-indicator {
                font-size: 1.2rem;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1> שם קוד</h1>

        <!-- מסך כניסה למשחק -->
        <div id="welcomeContainer" class="welcome-panel">
            <h2>ברוכים הבאים למשחק שם קוד</h2>

            <div>
                <h3>בחר את התפקיד שלך:</h3>
                <div class="role-selection">
                    <div class="role-card" data-role="gameManager">
                        <div class="role-icon">🎮</div>
                        <h3>מנהל משחק</h3>
                        <p>יכול לראות את כל המילים ואת הקלפים</p>
                    </div>
                    <div class="role-card" data-role="blueSpymaster">
                        <div class="role-icon">🔍</div>
                        <h3>ראש מודיעין כחול</h3>
                        <p>רואה את הכל ונותן רמזים</p>
                    </div>
                    <div class="role-card" data-role="redSpymaster">
                        <div class="role-icon">🔎</div>
                        <h3>ראש מודיעין אדום</h3>
                        <p>רואה את הכל ונותן רמזים</p>
                    </div>
                    <div class="role-card" data-role="player">
                        <div class="role-icon">👤</div>
                        <h3>שחקן רגיל</h3>
                        <p>מנחש את המילים לפי הרמזים</p>
                    </div>
                </div>
            </div>

            <div class="game-code-container">
                <h3>צור משחק חדש:</h3>
                <button id="createGameBtn" class="primary-btn">צור משחק חדש</button>
                <div id="gameCodeCreator" style="display: none; margin-top: 15px;">
                    <p>קוד המשחק שלך:</p>
                    <div class="game-code-display" id="generatedGameCode"></div>
                    <p>שתף את הקוד עם שאר המשתתפים</p>
                    <button id="startGameBtn" class="primary-btn">התחל משחק</button>
                </div>

                <div class="divider"></div>

                <h3>הצטרף למשחק קיים:</h3>
                <div>
                    <input type="text" id="gameCodeInput" class="game-code-input" placeholder="הזן קוד משחק" />
                    <button id="joinGameBtn" class="primary-btn">הצטרף למשחק</button>
                </div>
            </div>

            <div class="game-info">
                <h3>איך משחקים?</h3>
                <p>
                    <strong>מנהל המשחק:</strong> רואה את כל הלוח ומנהל את המשחק.<br>
                    <strong>ראשי המודיעין:</strong> רואים את כל הקלפים ונותנים רמזים לקבוצה שלהם.<br>
                    <strong>שחקנים:</strong> בכל תור, יש לנחש את הקלפים של הקבוצה לפי הרמז שקיבלתם מראש המודיעין.
                </p>
                <p>קבוצה מנצחת אם חשפה את כל הקלפים שלה. אם קבוצה חושפת את הקלף השחור - היא מפסידה מיד!</p>
            </div>
        </div>

        <!-- מסך המשחק עצמו -->
        <div id="gameContainer">
            <div class="current-game-info">
                קוד משחק: <span id="currentGameCode"></span> |
                תפקיד: <span id="currentRole"></span>
            </div>

            <div class="controls">
                <button id="newGameBtn" class="neutral-btn">משחק חדש</button>
                <span id="spymasterControls" style="display: none;">
                    <button id="spymasterViewBtn" class="primary-btn">הצג/הסתר קלפים</button>
                </span>
                <button id="backToLobbyBtn" class="neutral-btn">חזרה ללובי</button>
            </div>

            <div class="turn-indicator" id="turnIndicator">תור הקבוצה הכחולה</div>

            <div id="gameBoard" class="game-board">
                <!-- הלוח ייווצר דינמית ע"י JavaScript -->
            </div>

            <div id="clueSection" style="display: none;">
                <h3>הרמז האחרון:</h3>
                <div id="lastClue" style="font-size: 1.2rem; margin: 10px 0;">-</div>
            </div>
        </div>
    </div>

    <script>
// מאגר מילים בעברית מורחב
const hebrewWords = {
            // מקומות וגיאוגרפיה
            מקומות: [
                'ישראל', 'ירושלים', 'תל-אביב', 'חיפה', 'אילת', 'נגב', 'גליל', 'כרמל',
                'ים-המלח', 'כנרת', 'גולן', 'מצדה', 'ניו-יורק', 'פריז', 'לונדון', 'רומא',
                'מצרים', 'אמריקה', 'אירופה', 'אפריקה', 'אסיה', 'אוסטרליה', 'אנטארקטיקה',
                'מדבר', 'הר', 'עמק', 'נהר', 'אגם', 'אוקיינוס', 'יער', 'חוף', 'מפרץ',
                'אי', 'סיני', 'ערבה', 'יהודה', 'שומרון', 'באר-שבע', 'נצרת', 'עכו', 'טבריה',
                'ים-סוף', 'ים-התיכון', 'הר-הבית', 'כותל', 'מכתש', 'חרמון', 'דימונה', 'רמת-גן'
            ],

            // משפחה וחברה
            משפחה: [
                'אבא', 'אמא', 'הורים', 'אח', 'אחות', 'בן', 'בת', 'סבא', 'סבתא',
                'דוד', 'דודה', 'בן-דוד', 'בת-דודה', 'חתן', 'כלה', 'נישואין', 'משפחה',
                'חבר', 'חברה', 'ידיד', 'שכן', 'קהילה', 'חברות', 'אהבה', 'זוגיות',
                'תינוק', 'ילד', 'נער', 'מבוגר', 'זקן', 'גיל', 'דור', 'מסיבה', 'חתונה'
            ],

            // מקצועות ועיסוקים
            מקצועות: [
                'מורה', 'רופא', 'מהנדס', 'עורך-דין', 'שופט', 'שוטר', 'חייל', 'טייס',
                'נהג', 'מלצר', 'טבח', 'זמר', 'שחקן', 'צייר', 'סופר', 'מדען', 'חקלאי',
                'אדריכל', 'חשמלאי', 'נגר', 'מתכנת', 'מנהל', 'פקיד', 'רואה-חשבון',
                'גנן', 'דייג', 'צלם', 'מעצב', 'אמן', 'מוזיקאי', 'פסיכולוג', 'מתרגם'
            ],

            // טבע וחיות
            טבע: [
                'שמש', 'ירח', 'כוכב', 'שמיים', 'עננים', 'גשם', 'שלג', 'רוח', 'סערה',
                'ברק', 'רעם', 'קשת', 'עץ', 'פרח', 'דשא', 'שיח', 'יער', 'מדבר', 'הר',
                'עמק', 'נהר', 'ים', 'אוקיינוס', 'חוף', 'אי', 'מפל', 'גשר', 'מערה',
                'סלע', 'אדמה', 'חול', 'אבן', 'מעיין', 'באר', 'אגם', 'גבעה', 'גיא',
                'חתול', 'כלב', 'סוס', 'פרה', 'כבשה', 'עז', 'תרנגול', 'ציפור', 'דג',
                'נחש', 'צב', 'ג\'ירפה', 'פיל', 'אריה', 'נמר', 'זאב', 'דוב', 'קוף',
                'עכבר', 'ארנב', 'סנאי', 'נשר', 'ינשוף', 'עטלף', 'לטאה', 'עכביש', 'נמלה',
                'פרפר', 'דבורה', 'חיפושית', 'תולעת', 'ברווז', 'ברבור', 'יונה', 'תוכי'
            ],

            // מזון ואוכל
            מזון: [
                'לחם', 'חלב', 'גבינה', 'ביצה', 'בשר', 'עוף', 'דג', 'אורז', 'פסטה',
                'פיצה', 'המבורגר', 'שניצל', 'פלאפל', 'חומוס', 'טחינה', 'סלט', 'מרק',
                'תפוח', 'בננה', 'תפוז', 'לימון', 'אבטיח', 'מלון', 'ענבים', 'אגס',
                'תות', 'אננס', 'מנגו', 'אפרסק', 'שזיף', 'דובדבן', 'אבוקדו', 'זית',
                'שוקולד', 'גלידה', 'עוגה', 'עוגיות', 'קינוח', 'סוכר', 'מלח', 'פלפל',
                'קפה', 'תה', 'מיץ', 'מים', 'יין', 'בירה', 'קולה', 'חלווה', 'דבש'
            ],

            // בית וחפצים
            בית: [
                'בית', 'דירה', 'חדר', 'מטבח', 'סלון', 'שירותים', 'מקלחת', 'אמבטיה',
                'חלון', 'דלת', 'מדרגות', 'מעלית', 'גג', 'רצפה', 'קיר', 'תקרה', 'מרפסת',
                'גינה', 'חצר', 'ארון', 'שולחן', 'כיסא', 'ספה', 'מיטה', 'שטיח', 'וילון',
                'מנורה', 'מקרר', 'תנור', 'כיריים', 'מיקרוגל', 'מכונת-כביסה', 'מייבש',
                'טלוויזיה', 'מחשב', 'טלפון', 'רדיו', 'שעון', 'מזגן', 'מאוורר', 'תמונה',
                'מראה', 'ספר', 'עיתון', 'מפתח', 'ארנק', 'תיק', 'מברשת', 'מסרק', 'סבון',
                'מגבת', 'שמיכה', 'כרית', 'מזרן', 'מגירה', 'מדף', 'אגרטל', 'פמוט'
            ],

            // תחבורה וכלי רכב
            תחבורה: [
                'מכונית', 'אוטובוס', 'אופניים', 'רכבת', 'מטוס', 'ספינה', 'סירה',
                'אופנוע', 'משאית', 'מונית', 'הליקופטר', 'רכבל', 'רכבת-קלה', 'מטרו',
                'קטנוע', 'טרקטור', 'מנוף', 'אמבולנס', 'כבאית', 'ניידת', 'טנק', 'ג\'יפ',
                'כביש', 'מסילה', 'שדה-תעופה', 'נמל', 'תחנה', 'תחנת-דלק', 'חניה',
                'גלגל', 'מנוע', 'הגה', 'בלם', 'מושב', 'חגורה', 'צמיג', 'מהירות'
            ],

            // ביגוד ואופנה
            ביגוד: [
                'חולצה', 'מכנסיים', 'שמלה', 'חצאית', 'מעיל', 'סוודר', 'גרביים', 'נעליים',
                'סנדלים', 'מגפיים', 'כובע', 'כפפות', 'צעיף', 'עניבה', 'חגורה', 'תיק',
                'תכשיט', 'טבעת', 'שרשרת', 'עגילים', 'צמיד', 'שעון', 'משקפיים', 'משקפי-שמש',
                'בגד-ים', 'פיג\'מה', 'חליפה', 'בגדים', 'אופנה', 'סגנון', 'מידה', 'צבע'
            ],

            // לימודים וחינוך
            חינוך: [
                'בית-ספר', 'גן', 'אוניברסיטה', 'מכללה', 'כיתה', 'מורה', 'תלמיד', 'סטודנט',
                'שיעור', 'הרצאה', 'בחינה', 'מבחן', 'בית-ספר', 'ציון', 'תעודה', 'דיפלומה',
                'קריאה', 'כתיבה', 'חשבון', 'מדע', 'היסטוריה', 'גיאוגרפיה', 'אנגלית',
                'ספרות', 'אמנות', 'מוזיקה', 'ספורט', 'מחקר', 'פרויקט', 'הפסקה',
                'תרגיל', 'שיעורי-בית', 'מחברת', 'ספר', 'עפרון', 'עט', 'מחק', 'סרגל',
                'תיק', 'קלמר', 'מחשבון', 'לוח', 'גיר', 'טוש', 'מרקר', 'מספריים'
            ],

            // בידור ופנאי
            בידור: [
                'טלוויזיה', 'סרט', 'קולנוע', 'תיאטרון', 'מופע', 'הצגה', 'קונצרט',
                'פסטיבל', 'מוזיאון', 'גלריה', 'פארק', 'גן-חיות', 'ספארי', 'לונה-פארק',
                'חופשה', 'נופש', 'טיול', 'נסיעה', 'מסע', 'מלון', 'אוהל', 'קמפינג',
                'משחק', 'צעצוע', 'פאזל', 'קלפים', 'שחמט', 'דמקה', 'מונופול', 'טריוויה',
                'ספר', 'עיתון', 'מגזין', 'חידון', 'תשבץ', 'סודוקו', 'קריאה', 'כתיבה',
                'ציור', 'פיסול', 'מוזיקה', 'שירה', 'ריקוד', 'תחביב', 'אוסף', 'גינון'
            ],

            // ספורט ותנועה
            ספורט: [
                'כדורגל', 'כדורסל', 'כדורעף', 'טניס', 'שחייה', 'ריצה', 'הליכה', 'קפיצה',
                'רכיבה', 'סקי', 'גלישה', 'טיפוס', 'התעמלות', 'אתלטיקה', 'היאבקות', 'אגרוף',
                'ג׳ודו', 'קארטה', 'אימון', 'כושר', 'משקולות', 'יוגה', 'מתיחות', 'חימום',
                'אולימפיאדה', 'תחרות', 'אליפות', 'גביע', 'מדליה', 'ניצחון', 'הפסד', 'שיא',
                'הוקי', 'קריקט', 'גולף', 'רוגבי', 'בייסבול', 'כדוריד', 'סנוקר', 'באולינג'
            ],

            // טכנולוגיה ומדע
            טכנולוגיה: [
                'מחשב', 'טלפון', 'אינטרנט', 'רשת', 'אתר', 'דף', 'מייל', 'הודעה', 'צ׳אט',
                'אפליקציה', 'תוכנה', 'קוד', 'תכנות', 'מידע', 'נתונים', 'קובץ', 'תיקייה',
                'מסך', 'מקלדת', 'עכבר', 'רמקול', 'מיקרופון', 'מצלמה', 'סוללה', 'חשמל',
                'רובוט', 'דרון', 'לוויין', 'חללית', 'טלסקופ', 'מיקרוסקופ', 'אטום', 'מולקולה',
                'אנרגיה', 'חומר', 'גז', 'נוזל', 'מוצק', 'כימיה', 'פיזיקה', 'ביולוגיה',
                'רפואה', 'תרופה', 'ניתוח', 'בדיקה', 'אבחון', 'מחלה', 'חיסון', 'רופא',
                'מהנדס', 'מדען', 'מחקר', 'גילוי', 'המצאה', 'פטנט', 'מעבדה', 'ניסוי'
            ],

            // זמן ומועדים
            זמן: [
                'שעה', 'דקה', 'שנייה', 'יום', 'שבוע', 'חודש', 'שנה', 'עשור', 'מאה', 'אלף',
                'בוקר', 'צהריים', 'ערב', 'לילה', 'אתמול', 'היום', 'מחר', 'עבר', 'הווה', 'עתיד',
                'ראשון', 'שני', 'שלישי', 'רביעי', 'חמישי', 'שישי', 'שבת', 'סופשבוע',
                'ינואר', 'פברואר', 'מרץ', 'אפריל', 'מאי', 'יוני', 'יולי', 'אוגוסט',
                'ספטמבר', 'אוקטובר', 'נובמבר', 'דצמבר', 'חורף', 'אביב', 'קיץ', 'סתיו',
                'חג', 'ראש-השנה', 'יום-כיפור', 'סוכות', 'חנוכה', 'פורים', 'פסח', 'שבועות',
                'יום-העצמאות', 'יום-הזיכרון', 'יום-השואה', 'ל״ג-בעומר', 'ט״ו-בשבט'
            ],

            // תרבות וסגנונות
            תרבות: [
                'שפה', 'דיבור', 'מילה', 'משפט', 'סיפור', 'שיר', 'שירה', 'פואמה', 'חרוז',
                'ספר', 'סופר', 'משורר', 'סרט', 'במאי', 'שחקן', 'מחזה', 'תסריט', 'דיאלוג',
                'מוזיקה', 'מלחין', 'זמר', 'להקה', 'תזמורת', 'קונצרט', 'אלבום', 'גיטרה',
                'פסנתר', 'כינור', 'תופים', 'חליל', 'סקסופון', 'אמנות', 'אמן', 'צייר',
                'פסל', 'צילום', 'צלם', 'עיצוב', 'מעצב', 'אדריכל', 'בניין', 'מבנה',
                'קלאסי', 'מודרני', 'עתיק', 'חדש', 'מסורתי', 'פופולרי', 'אופנתי', 'וינטג׳'
            ],

            // מספרים ומתמטיקה
            מספרים: [
                'אחד', 'שתיים', 'שלוש', 'ארבע', 'חמש', 'שש', 'שבע', 'שמונה', 'תשע', 'עשר',
                'עשרים', 'שלושים', 'מאה', 'אלף', 'מיליון', 'מיליארד', 'חצי', 'רבע', 'שליש',
                'ראשון', 'שני', 'שלישי', 'רביעי', 'חמישי', 'אחוז', 'חיבור', 'חיסור', 'כפל',
                'חילוק', 'חשבון', 'מתמטיקה', 'אלגברה', 'גיאומטריה', 'משולש', 'ריבוע', 'עיגול',
                'מלבן', 'קו', 'נקודה', 'זווית', 'מעלה', 'אורך', 'רוחב', 'גובה', 'עומק',
                'מטר', 'סנטימטר', 'קילומטר', 'גרם', 'קילו', 'טון', 'ליטר', 'מילימטר'
            ],

            // רגשות ותחושות
            רגשות: [
                'שמחה', 'עצב', 'כעס', 'פחד', 'הפתעה', 'גועל', 'אהבה', 'שנאה', 'קנאה',
                'גאווה', 'בושה', 'אשמה', 'בלבול', 'תקווה', 'ייאוש', 'שעמום', 'התרגשות',
                'חרדה', 'לחץ', 'רוגע', 'סיפוק', 'אכזבה', 'הקלה', 'געגוע', 'בדידות',
                'צחוק', 'בכי', 'חיוך', 'דמעה', 'צעקה', 'לחישה', 'מגע', 'חיבוק', 'נשיקה',
                'כאב', 'עונג', 'חום', 'קור', 'רעב', 'צמא', 'עייפות', 'רעננות', 'סחרחורת'
            ],

            // מקצועות ועיסוקים נוספים
            מקצועות_נוספים: [
                'מנהל', 'פקיד', 'מזכיר', 'מנקה', 'שומר', 'גנן', 'ספר', 'מעצב-שיער',
                'קוסמטיקאית', 'פיזיותרפיסט', 'דוגמן', 'דוגמנית', 'שף', 'קונדיטור',
                'ברמן', 'מאמן', 'מדריך', 'יועץ', 'פסיכולוג', 'עובד-סוציאלי', 'אח',
                'אחות', 'רוקח', 'וטרינר', 'מהנדס-תוכנה', 'מתכנת', 'מנתח-מערכות',
                'מעצב-גרפי', 'אנימטור', 'כתב', 'עיתונאי', 'קריין', 'שדרן', 'מפיק',
                'במאי', 'צלם', 'עורך', 'מתרגם', 'מורה-דרך', 'טייס', 'דייל', 'נהג'
            ]
};

// שטיחת כל המילים למערך אחד
const allHebrewWords = Object.values(hebrewWords).flat();

// מצב המשחק
let gameState = {
            board: [],
            spymasterView: false,
            blueTeamTurn: true,
            gameCode: '',
            currentRole: ''
};

// יצירת קוד משחק ייחודי
function generateGameCode() {
            return Math.random().toString(36).substring(2, 7).toUpperCase();
}

// שמירת מצב המשחק עם הקוד
function saveGameState() {
            localStorage.setItem(gameState.gameCode, JSON.stringify({
                board: gameState.board,
                blueTeamTurn: gameState.blueTeamTurn,
                timestamp: new Date().getTime()
            }));
}

// טעינת מצב משחק לפי קוד
function loadGameState(gameCode) {
            const savedState = localStorage.getItem(gameCode);
            if (savedState) {
                const parsedState = JSON.parse(savedState);
                gameState.board = parsedState.board;
                gameState.blueTeamTurn = parsedState.blueTeamTurn;
                gameState.gameCode = gameCode;
                return true;
            }
            return false;
}

// אתחול משחק חדש
function initializeGame() {
            // ערבוב המילים ובחירת 25
            const shuffledWords = [...allHebrewWords].sort(() => 0.5 - Math.random()).slice(0, 25);

            // יצירת לוח משחק
            gameState.board = shuffledWords.map((word, index) => {
                let type = 'neutral';

                if (index < 9) type = 'blue';
                else if (index < 17) type = 'red';
                else if (index === 17) type = 'assassin';

                return {
                    word,
                    type,
                    revealed: false
                };
            });

            // ערבוב הלוח
            gameState.board.sort(() => 0.5 - Math.random());
            gameState.blueTeamTurn = true;

            // שמירת המשחק בלוקל סטורג' עם הקוד
            saveGameState();

            updateTurnIndicator();
            renderBoard();
}

// עדכון סמן התור
function updateTurnIndicator() {
            const turnIndicator = document.getElementById('turnIndicator');
            turnIndicator.textContent = `תור הקבוצה ${gameState.blueTeamTurn ? 'הכחולה' : 'האדומה'}`;
            turnIndicator.className = 'turn-indicator';
            turnIndicator.classList.add(gameState.blueTeamTurn ? 'blue-turn' : 'red-turn');
}

// הצגת הלוח
function renderBoard() {
            const boardElement = document.getElementById('gameBoard');
            boardElement.innerHTML = '';

            const isSpymaster = gameState.currentRole === 'blueSpymaster' ||
                gameState.currentRole === 'redSpymaster' ||
                gameState.currentRole === 'gameManager';

            gameState.board.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                if (card.revealed) {
                    cardElement.classList.add('revealed');
                }
                cardElement.textContent = card.word;

                // הוסף מחלקות CSS בהתאם למצב הקלף
                if (card.revealed || (isSpymaster && gameState.spymasterView)) {
                    cardElement.classList.add(card.type);
                }

                // הוסף מאזין אירועים ללחיצה - רק למנהל משחק ושחקנים רגילים יכולים לחשוף קלפים
                if (!card.revealed && (gameState.currentRole === 'gameManager' || gameState.currentRole === 'player')) {
                    cardElement.addEventListener('click', () => {
                        revealCard(index);
                    });
                }

                boardElement.appendChild(cardElement);
            });
}

// חשיפת קלף
function revealCard(index) {
            const card = gameState.board[index];
            card.revealed = true;

            // בדיקה אם הקבוצה הנוכחית צריכה להחליף תור
            if (card.type !== (gameState.blueTeamTurn ? 'blue' : 'red')) {
                gameState.blueTeamTurn = !gameState.blueTeamTurn;
                updateTurnIndicator();
            }

            // שמירת המצב המעודכן
            saveGameState();

            renderBoard();

            // בדיקת סיום משחק
            checkGameEnd();
}

// בדיקת סיום משחק
function checkGameEnd() {
            const blueCardsLeft = gameState.board.filter(card => card.type === 'blue' && !card.revealed).length;
            const redCardsLeft = gameState.board.filter(card => card.type === 'red' && !card.revealed).length;
            const assassinRevealed = gameState.board.some(card => card.type === 'assassin' && card.revealed);

            if (blueCardsLeft === 0) {
                alert('הקבוצה הכחולה ניצחה!');
            } else if (redCardsLeft === 0) {
                alert('הקבוצה האדומה ניצחה!');
            } else if (assassinRevealed) {
                alert(`הקבוצה ${gameState.blueTeamTurn ? 'האדומה' : 'הכחולה'} ניצחה! נבחר המתנקש.`);
            }
}

// הצגת מסך המשחק והסתרת מסך הכניסה
function showGameScreen() {
            document.getElementById('welcomeContainer').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'block';
            document.getElementById('currentGameCode').textContent = gameState.gameCode;
            document.getElementById('currentRole').textContent = translateRole(gameState.currentRole);

            // הצג/הסתר כפתורי ראש מודיעין בהתאם לתפקיד
            if (gameState.currentRole === 'blueSpymaster' ||
                gameState.currentRole === 'redSpymaster' ||
                gameState.currentRole === 'gameManager') {
                document.getElementById('spymasterControls').style.display = 'inline-block';
            } else {
                document.getElementById('spymasterControls').style.display = 'none';
            }
}

// תרגום התפקיד לעברית
function translateRole(role) {
            switch (role) {
                case 'gameManager': return 'מנהל משחק';
                case 'blueSpymaster': return 'ראש מודיעין כחול';
                case 'redSpymaster': return 'ראש מודיעין אדום';
                case 'player': return 'שחקן';
                default: return role;
            }
}

// יצירת משחק חדש עם קוד
function createNewGame() {
            if (!gameState.currentRole) {
                alert('יש לבחור תפקיד לפני יצירת משחק');
                return;
            }

            gameState.gameCode = generateGameCode();
            document.getElementById('generatedGameCode').textContent = gameState.gameCode;
            document.getElementById('gameCodeCreator').style.display = 'block';
}

// הצטרפות למשחק קיים
function joinGame() {
            if (!gameState.currentRole) {
                alert('יש לבחור תפקיד לפני הצטרפות למשחק');
                return;
            }

            const gameCode = document.getElementById('gameCodeInput').value.trim().toUpperCase();

            if (!gameCode) {
                alert('יש להזין קוד משחק');
                return;
            }

            if (loadGameState(gameCode)) {
                showGameScreen();
                renderBoard();
                updateTurnIndicator();
            } else {
                alert('קוד משחק לא תקין או שהמשחק לא קיים');
            }
}

// יצירת קישור לשיתוף
function createShareLink(gameCode, role) {
            const url = new URL(window.location.href);
            url.search = '';
            url.searchParams.set('code', gameCode);
            if (role) {
                url.searchParams.set('role', role);
            }
            return url.toString();
}

// הוספת מאזיני אירועים לכפתורים
document.addEventListener('DOMContentLoaded', () => {
            // בחירת תפקיד
            const roleCards = document.querySelectorAll('.role-card');
            roleCards.forEach(card => {
                card.addEventListener('click', () => {
                    // הסר סימון מכל הכרטיסים
                    roleCards.forEach(c => c.classList.remove('selected'));
                    // סמן את הכרטיס הנבחר
                    card.classList.add('selected');
                    // שמור את התפקיד הנבחר
                    gameState.currentRole = card.dataset.role;
                });
            });

            // כפתורי מסך הכניסה
            document.getElementById('createGameBtn').addEventListener('click', createNewGame);
            document.getElementById('joinGameBtn').addEventListener('click', joinGame);

            document.getElementById('startGameBtn').addEventListener('click', () => {
                initializeGame();
                showGameScreen();
            });

            // כפתורי מסך המשחק
            document.getElementById('newGameBtn').addEventListener('click', () => {
                if (confirm('האם אתה בטוח שברצונך להתחיל משחק חדש?')) {
                    initializeGame();
                }
            });

            document.getElementById('spymasterViewBtn').addEventListener('click', () => {
                gameState.spymasterView = !gameState.spymasterView;
                renderBoard();
            });

            document.getElementById('backToLobbyBtn').addEventListener('click', () => {
                document.getElementById('welcomeContainer').style.display = 'block';
                document.getElementById('gameContainer').style.display = 'none';
                document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
                gameState.currentRole = '';
            });

            // בדיקה אם יש קוד משחק ב-URL
            const urlParams = new URLSearchParams(window.location.search);
            const gameCodeFromUrl = urlParams.get('code');

            if (gameCodeFromUrl) {
                document.getElementById('gameCodeInput').value = gameCodeFromUrl;

                // אם יש גם תפקיד ב-URL, בחר אותו אוטומטית
                const roleFromUrl = urlParams.get('role');
                if (roleFromUrl) {
                    const roleCard = document.querySelector(`.role-card[data-role="${roleFromUrl}"]`);
                    if (roleCard) {
                        roleCard.click();
                    }
                }
            }
});
    </script>
</body>
</html>